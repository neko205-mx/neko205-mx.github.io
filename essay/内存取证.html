<h1>å†…å­˜å–è¯</h1>
<p>å·¥å…·ï¼šVolatility2</p>
<p>è½¯ä»¶å¯ä»¥é€šè¿‡githubä¸‹è½½ éœ€è¦é…ç½®python2ä¸pip2ç¯å¢ƒ</p>
<p><code>https://github.com/volatilityfoundation/volatility</code></p>
<p><img src="https://camo.githubusercontent.com/eeafeeaf1e41ff270b6f855ae44bfd1561649ae5395ca3a11c8c951cbc7ba58b/68747470733a2f2f696d672d626c6f672e6373646e696d672e636e2f37613838393866636331623134623535623764343831306333306666353638392e706e67" alt="" /></p>
<p>å¦‚æœç³»ç»Ÿä¸ºArchLinuxå¯ä»¥é€šè¿‡aurå®‰è£…</p>
<p><code>yay python2-volatility</code></p>
<h2>å·¥å…·ä½¿ç”¨æ–¹æ³•</h2>
<table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>æ•ˆæœ</th>
</tr>
</thead>
<tbody>
<tr>
<td>-f</td>
<td>å¼•å…¥é•œåƒ</td>
</tr>
<tr>
<td>imageinfo</td>
<td>æŸ¥è¯¢é•œåƒè¯¦ç»†ä¿¡æ¯</td>
</tr>
<tr>
<td>--profile=sysinfo</td>
<td>ä½¿ç”¨ä½•ç§é…ç½®æ–‡ä»¶</td>
</tr>
<tr>
<td>pslist</td>
<td>[æ’ä»¶]éå†å†…å­˜é•œåƒä¸­çš„è¿›ç¨‹</td>
</tr>
<tr>
<td>procdump</td>
<td>[æ’ä»¶]æå–å†…å­˜é•œåƒä¸­çš„è¿›ç¨‹å¹¶ä¸”ä¿å­˜æˆæ–‡ä»¶</td>
</tr>
<tr>
<td>cmdscan</td>
<td>[æ’ä»¶]æå–å·²æ‰§è¡Œçš„cmdå‘½ä»¤</td>
</tr>
<tr>
<td>cmdline</td>
<td>[æ’ä»¶]æå–å‘½ä»¤è¡Œå‚æ•°ä¸å‚æ•°å€¼</td>
</tr>
<tr>
<td>filescan</td>
<td>[æ’ä»¶]æŸ¥è¯¢å·²ç»æ‰“å¼€çš„æ–‡ä»¶ è·å¾—è¯¦ç»†ä¿¡æ¯</td>
</tr>
<tr>
<td>dumpfiles</td>
<td>[æ’ä»¶]æå–ç³»ç»Ÿå†…å­˜ä¸­çš„æ–‡ä»¶</td>
</tr>
<tr>
<td>hashdump</td>
<td>[æ’ä»¶]æå–ç³»ç»Ÿå†…å­˜ä¸­å¯†ç çš„hashå€¼</td>
</tr>
<tr>
<td>mimikatz</td>
<td>[æ’ä»¶]ç›´æ¥æå–å†…å­˜ä¸­çš„æ˜æ–‡å¯†ç </td>
</tr>
<tr>
<td>clipboard</td>
<td>[æ’ä»¶]æå–å‰ªè´´æ¿æ•°æ®</td>
</tr>
<tr>
<td>svcscan</td>
<td>[æ’ä»¶]æ‰«æè¿›ç¨‹ä¸­æ‰€æœ‰çš„æœåŠ¡</td>
</tr>
<tr>
<td>netscan</td>
<td>[æ’ä»¶]æ‰«æå†…å­˜ä¸­çš„ç½‘ç»œè¿æ¥å’Œå¥—æ¥å­—</td>
</tr>
<tr>
<td>printkey</td>
<td>[æ’ä»¶]æ³¨å†Œè¡¨åˆ†æ_é”®å€¼</td>
</tr>
<tr>
<td>hivelist</td>
<td>[æ’ä»¶]æ³¨å†Œè¡¨åˆ†æ_åœ°å€</td>
</tr>
<tr>
<td>hivedump</td>
<td>[æ’ä»¶]æ³¨å†Œè¡¨åˆ†æ_dumpæ•°æ®</td>
</tr>
<tr>
<td>timeliner</td>
<td>åˆ›å»ºå†…å­˜ä¸­çš„ç—•è¿¹æ—¶é—´çº¿</td>
</tr>
</tbody>
</table>
<h2>è¯¦ç»†ä½¿ç”¨</h2>
<p>æ— è®ºæ‹¿åˆ°æ‰«ææ ·å­çš„é¢˜ç›®ç¬¬ä¸€æ­¥éƒ½æ˜¯æŸ¥çœ‹ç³»ç»Ÿé•œåƒï¼Œåˆ©ç”¨imageinfoæŸ¥çœ‹è¯¦ç»†é•œåƒä¿¡æ¯</p>
<p><code>vol.py -f 1.vmem imageinfo</code></p>
<pre><code class="language-shell">INFO    : volatility.debug    : Determining profile based on KDBG search...
          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418
                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)
                     AS Layer2 : FileAddressSpace (/home/neko/Desktop/1.vmem)
                      PAE type : No PAE
                           DTB : 0x187000L
                          KDBG : 0xf80003e520a0L
          Number of Processors : 1
     Image Type (Service Pack) : 1
                KPCR for CPU 0 : 0xfffff80003e53d00L
             KUSER_SHARED_DATA : 0xfffff78000000000L
           Image date and time : 2021-04-21 07:24:54 UTC+0000
     Image local date and time : 2021-04-21 15:24:54 +0800

</code></pre>
<p>é€šè¿‡æŸ¥çœ‹Suggested Profile(s)å­—æ®µç¡®å®šéœ€è¦ä½¿ç”¨çš„å†…å­˜é•œåƒåˆ†æé…ç½®æ–‡ä»¶</p>
<p><code>vol.py -f 1.vmem --profile=Win7SP1x64 pslist</code></p>
<pre><code class="language-shell">Volatility Foundation Volatility Framework 2.6
Offset(V)          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit                        
------------------ -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------
0xfffffa8018db89e0 System                    4      0     74      562 ------      0 2021-04-21 07:16:07 UTC+0000                               
0xfffffa801a449040 smss.exe                224      4      2       29 ------      0 2021-04-21 07:16:07 UTC+0000                               
0xfffffa801ab72b30 csrss.exe               308    300      9      473      0      0 2021-04-21 07:16:08 UTC+0000                               
0xfffffa8018dbd5f0 wininit.exe             344    300      3       75      0      0 2021-04-21 07:16:08 UTC+0000                               
0xfffffa801ab82060 csrss.exe               356    336      8      315      1      0 2021-04-21 07:16:08 UTC+0000                               
0xfffffa801abbf060 winlogon.exe            404    336      7      131      1      0 2021-04-21 07:16:08 UTC+0000                                 ..........
</code></pre>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯pidæ•°å­—ï¼Œå¯ä»¥é€šè¿‡å®ƒdumpå‡ºå†…å­˜ä¸­çš„ç¨‹åº</p>
<p><code>vol.py -f 1.vmem --profile=Win7SP1x64 procdump -p 224 -D ./</code></p>
<p>pï¼šå°±æ˜¯pidè¿›ç¨‹å·</p>
<p>Dï¼šæå–ç¨‹åºåä¿å­˜çš„ä½ç½®ï¼Œ./å°±æ˜¯ä¿å­˜åˆ°å½“å‰ä½ç½®</p>
<pre><code class="language-shell">Volatility Foundation Volatility Framework 2.6
Process(V)         ImageBase          Name                 Result
------------------ ------------------ -------------------- ------
0xfffffa801a449040 0x0000000048490000 smss.exe             OK: executable.224.exe
</code></pre>
<h3>æ£€ç´¢ç»ˆç«¯ä¿¡æ¯</h3>
<p>volä¸­å¯ä»¥ä½¿ç”¨cmdscanæ‰«æå†…å­˜é•œåƒä¸­å·²ç»æ‰§è¡Œçš„cmdå‘½ä»¤</p>
<p><code>vol.py -f 1.vmem --profile=Win7SP1x64 cmdscan</code></p>
<pre><code class="language-shell">Volatility Foundation Volatility Framework 2.6
**************************************************
CommandProcess: conhost.exe Pid: 3400
CommandHistory: 0x317540 Application: cmd.exe Flags: Allocated
CommandCount: 0 LastAdded: -1 LastDisplayed: -1
FirstCommand: 0 CommandCountMax: 50
ProcessHandle: 0x5c
**************************************************
CommandProcess: conhost.exe Pid: 3400
CommandHistory: 0x317720 Application: csrss.exe Flags: Allocated
CommandCount: 0 LastAdded: -1 LastDisplayed: -1
FirstCommand: 0 CommandCountMax: 50
ProcessHandle: 0x88
</code></pre>
<p>è¿™ä¸ªé•œåƒå¹¶æ²¡æœ‰è¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹å…¶ä»–é•œåƒ</p>
<p><img src="https://camo.githubusercontent.com/174849bf730a63d69775ef2744ca8922dba97719f3da5435e1e2f7f1fd4fefa3/68747470733a2f2f696d672d626c6f672e6373646e696d672e636e2f31613239346533333533353334643533616366626334643638313933353230332e706e67" alt="" /></p>
<h2>é¢˜ç›®å®ä¾‹</h2>
<p>é¢˜ç›®åœ°å€ï¼šhttps://ctf.show/challenges#JiaJia-CP-1-1734</p>
<p>è¯¦ç»†ï¼š</p>
<pre><code>è¿™æ˜¯éƒ¨åˆ†äººç†ŸçŸ¥çš„**åˆ˜ä½³ä½³**åŒå­¦çš„ç”µè„‘ï¼Œå¥¹ä»Šå¹´21å²å·²åœ¨å…¬å¸é‡Œå®ä¹ ã€‚ä½†æ˜¯ä½³ä½³ç»å¸¸æ‘¸é±¼è¢«è€æ¿è®­æ–¥è¯´ï¼š&quot;ä½ æ€ä¹ˆæ‘¸å¾—ä¸‹å»çš„&quot;ã€‚å› æ­¤ä½³ä½³è¿˜ä¼šç»å¸¸å°†æœªå®Œæˆçš„å·¥ä½œå¸¦åˆ°å®¶é‡Œå»å®Œæˆ(~~è€æ¿ä¸ç•™å¥¹åŠ ç­å±å®æœ‰ç‚¹ç¦»è°±~~ã€‚ä½†æœ€è¿‘ä½³ä½³ä¸€å¤©æ‘¸é±¼çš„æ—¶é—´è¾¾åˆ°äº†25å°æ—¶ï¼Œè¿™ä»¤è€æ¿éå¸¸ä¸çˆ½ã€‚äºæ˜¯ğŸ•è€æ¿æ‚„æ‚„çš„æ¤å…¥äº†ä¸€ä¸ªè½¯ä»¶å¹¶åœ¨åå°è·å–äº†ä½³ä½³**ç”µè„‘çš„å†…å­˜ä¿¡æ¯**ã€‚ç”±äºè€æ¿ä¹Ÿæ˜¯ä¸ªæ‡’ğŸ•äºæ˜¯å«ä½ æ¥æ‰¾ä¸€ä¸‹è€æ¿æƒ³è¦çš„ä½³ä½³ç”µè„‘çš„ä¿¡æ¯ã€‚ä½œä¸ºåå¹´è€ç²‰çš„CTFerä»¬å¦‚æœä¸æ˜¯å› ä¸ºè¦æ‰¾åˆ°flagä¸€å®šä¸æƒ³å¸®è€æ¿æ¥çœ‹ä½³ä½³çš„ç”µè„‘å†…å­˜ä¿¡æ¯å§ï¼Œäºæ˜¯ä½ ä¹Ÿåªèƒ½æ¥å¸®åŠ©è€æ¿å¯»æ‰¾ä½³ä½³ç”µè„‘é‡Œçš„ä¿¡æ¯ã€‚~~ç”µè„‘é‡Œé¢æ²¡æœ‰å¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿ï¼Œä¸è¦ä¹±ç¿»æµªè´¹æ—¶é—´~~
é¢˜ç›®è§£å‹å¯†ç ï¼šTh1s_15_p@SsW0rd_u_n3ver_kn0w_b3f0re_BLB_St4rt

å¯é€šè¿‡éªŒè¯å‹ç¼©åŒ…md5å€¼æŸ¥çœ‹é™„ä»¶æ˜¯å¦æŸåï¼šde3b3febacdfa20d255e1014cd204a35

å…±3å¤§é¢˜ï¼Œç¬¬1å¤§é¢˜åšå‡ºæ¥å†ç»™ä½ ç¬¬2å¤§é¢˜å’Œç¬¬3å¤§é¢˜çš„é¢˜ç›®ï¼Œå“¼å“¼

1.ä½³ä½³çš„ç”µè„‘ç”¨æˆ·åå«ä»€ä¹ˆ(å³C:\Users\{name})

2.æœ€åä¸€æ¬¡è¿è¡Œè®¡ç®—å™¨çš„æ—¶é—´ï¼Ÿ(æ ¼å¼ä¸ºyyyy-mm-dd_hh:mm:ssï¼Œæ³¨æ„å†’å·ä¸ºè‹±æ–‡å†’å·)

flagæ ¼å¼ä¸ºctfshow{md5(A1_A2)}ï¼Œ format:ctfshow{ljj_2021-12-12_07:13:26}=ctfshow{c3cf135599d338093cbd2b578065be89}**

google cloudé“¾æ¥https://drive.google.com/file/d/1UvMTUXV76F-qh1FGtUpE_duo3V7cgO1f/view

duç›˜é“¾æ¥https://pan.baidu.com/s/1hVFPJhU8B4g8Kyy0ssDSLw?pwd=show

æå–ç ï¼šshow
</code></pre>
<p>å…ˆçœ‹é¢˜ç›®ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾å‡ºé•œåƒæ–‡ä»¶ä¸­ä½³ä½³çš„ç”¨æˆ·åä¸æœ€åä¸€æ¬¡è¿è¡Œè®¡ç®—æœºçš„æ—¶é—´ï¼ŒäºŒè€…ç»“åˆè®¡ç®—md5</p>
<p>å…ˆçœ‹ç¬¬ä¸€é¢˜ï¼Œéœ€è¦æˆ‘ä»¬æ‰¾å‡ºUsersä¸‹çš„ä½³ä½³çš„ç”¨æˆ·åï¼Œè¿™é‡Œå¯ä»¥ç”¨åˆ°filescanæ’ä»¶é…åˆgrepè¾“å‡ºæ¥æŸ¥è¯¢</p>
<p><code>vol.py -f JiaJia_Co.raw --profile=Win7SP1x64 filescan | grep Users</code></p>
<pre><code class="language-shell">0x000000013fdd8930     16      0 RW---- \Device\HarddiskVolume1\Users\JiaJia\AppData\Roaming\Telegram Desktop\Updater.exep
0x000000013fdda070     16      0 R--r-- \Device\HarddiskVolume1\Users\JiaJia\AppData\LocalLow\Microsoft\CryptnetUrlCache\MetaData\6025C34CC5B36C4156C40F3B0D99B6AB
0x000000013fde26a0     16      0 RW---- \Device\HarddiskVolume1\Users\JiaJia\AppData\Roaming\Telegram Desktop\Telegram.exe
0x000000013fde46d0      3      0 R--rw- \Device\HarddiskVolume1\Users\JiaJia\AppData\Local\Google\Chrome\User Data\Safe Browsing\UrlSoceng.store
0x000000013fde4930     16      0 R--r-- \Device\HarddiskVolume1\Users\JiaJia\AppData\LocalLow\Microsoft\CryptnetUrlCache\MetaData\F07644E38ED7C9F37D11EEC6D4335E02_E81D30836CB09660A7E3C5D921621623
0x000000013fded350     16      0 RW-rw- 
</code></pre>
<p><img src="https://picdm.sunbangyan.cn/2023/11/23/d61815de9a845dea4420fe8809ca84a4.jpeg" alt="" /></p>
<p>å¯çŸ¥ç”¨æˆ·åä¸ºJiaJia</p>
<p>ç¬¬äºŒé¢˜éœ€è¦æˆ‘ä»¬æ‰¾å‡ºè®¡ç®—å™¨â€”â€”ä¹Ÿå°±æ˜¯calc.exeï¼Œæˆ‘ä¹‹å‰çš„æ€è·¯æ˜¯æŸ¥è¯¢pslistæˆ–è€…filescanè¿‡æ»¤å‡ºcalcå­—ç¬¦ï¼Œç»“æœä¸è¡Œ</p>
<p>pslistå®Œå…¨æ²¡æœ‰è¾“å‡º	filescanå€’æ˜¯æœ‰è¾“å‡ºäº†ä½†æ˜¯æ²¡æœ‰æ—¶é—´ä¿¡æ¯</p>
<p><img src="https://picdl.sunbangyan.cn/2023/11/23/d71a8ffcc424d0b6f1c1af70621c863e.jpeg" alt="" /></p>
<p>åç»­åœ¨å¤§ä½¬çš„ç‚¹æ‹¨ä¸‹æ‰¾åˆ°äº†è¿™æ ·ä¸€ä¸ªå‘½ä»¤</p>
<p><img src="https://picss.sunbangyan.cn/2023/11/23/444963a243f053b64eab22e9d1e6fc23.jpeg" alt="" /></p>
<p>timelinerå¯ä»¥æ¢³ç†å‡ºå†…å­˜ä¸­ä¿¡æ¯çš„æ—¶é—´çº¿ é…åˆè¿‡æ»¤å‘½ä»¤ å°±æ˜¯</p>
<p><code>vol.py -f JiaJia_Co.raw --profile=Win7SP1x64 timeliner | grep calc.exe</code></p>
<p><img src="https://picss.sunbangyan.cn/2023/11/23/9d3d4593d99b481df96c6ebc46e2bd27.jpeg" alt="" /></p>
<p>å¾—åˆ°æ—¶é—´ä¿¡æ¯ï¼š2021-12-10 12:15:47</p>
<p>ä½†æ˜¯å› ä¸ºwindowså’Œlinuxçš„å·®å¼‚æ—¶é—´ç›¸å·®äº†8ä¸ªå°æ—¶ï¼Œä¹Ÿå°±æ˜¯æ—¶é—´éœ€è¦+8</p>
<p>å› æ­¤æ­£ç¡®æ—¶é—´åº”è¯¥æ˜¯ï¼š2021-12-10 20:15:47</p>
<p>flagæ ¼å¼ä¸ºctfshow{md5(A1_A2)}ï¼Œ format:ctfshow{ljj_2021-12-12_07:13:26}=ctfshow{c3cf135599d338093cbd2b578065be89}</p>
<p>JiaJia_2021-20-10_20:15:47</p>
<p>ctfshow{JiaJia_2021-12-10_12:15:47}</p>
<p>ctfshow{079249e3fc743bc2d0789f224e451ffd}</p>
<p>æ­£ç¡®é€šè¿‡ã€‚ã€‚ã€‚</p>
